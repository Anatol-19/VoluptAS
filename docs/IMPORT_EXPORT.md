# –ò–º–ø–æ—Ä—Ç –∏ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

## üì§ –≠–∫—Å–ø–æ—Ä—Ç

### Google Sheets Export

**–ú–µ–Ω—é:** –§–∞–π–ª ‚Üí –≠–∫—Å–ø–æ—Ä—Ç ‚Üí Google Sheets

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü –ë–î –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ª–∏—Å—Ç—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ/–æ—á–∏—Å—Ç–∫–∞ –ª–∏—Å—Ç–æ–≤
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö

**–õ–∏—Å—Ç—ã –≤ —Ç–∞–±–ª–∏—Ü–µ:**
1. **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª** - –≤—Å–µ functional_items (18 –∫–æ–ª–æ–Ω–æ–∫)
2. **–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏** - users (7 –∫–æ–ª–æ–Ω–æ–∫) 
3. **–°–≤—è–∑–∏** - relations (11 –∫–æ–ª–æ–Ω–æ–∫)

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞:**
1. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí Google API ‚Üí –≤—Å—Ç–∞–≤–∏—Ç—å service_account.json
2. –†–∞—Å—à–∞—Ä–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É –Ω–∞ email –∏–∑ JSON (client_email)
3. –§–∞–π–ª ‚Üí –≠–∫—Å–ø–æ—Ä—Ç ‚Üí Google Sheets ‚Üí –≤—Å—Ç–∞–≤–∏—Ç—å URL

**‚ö†Ô∏è –í–∞–∂–Ω–æ:**
- –≠–∫—Å–ø–æ—Ä—Ç –æ—á–∏—â–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ª–∏—Å—Ç—ã
- –ï—Å–ª–∏ –ë–î –ø—É—Å—Ç–∞—è - –ª–∏—Å—Ç—ã –ù–ï –æ—á–∏—â–∞—é—Ç—Å—è (safe mode)
- Credentials –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –û–î–ò–ù —Ä–∞–∑ –≤ Settings

---

### CSV Export

**–ú–µ–Ω—é:** –§–∞–π–ª ‚Üí –≠–∫—Å–ø–æ—Ä—Ç ‚Üí CSV

**–§–æ—Ä–º–∞—Ç:**
```csv
FuncID,Alias,Title,Type,Module,Epic,QA,Dev,Segment,Crit,Focus
front,,,[Module]: FRONT,Module,,,,,,
```

**–ö–æ–ª–æ–Ω–∫–∏:**
- FuncID, Alias, Title, Type, Module, Epic
- QA, Dev (–∏–º–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
- Segment, Crit (1/0), Focus (1/0)

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- –ë—ã—Å—Ç—Ä—ã–π backup
- –û–±–º–µ–Ω –¥–∞–Ω–Ω—ã–º–∏ –º–µ–∂–¥—É –º–∞—à–∏–Ω–∞–º–∏
- –ü—Ä–æ—Å—Ç–æ–π –∏–º–ø–æ—Ä—Ç

---

## üì• –ò–º–ø–æ—Ä—Ç

### Google Sheets Import

**–ú–µ–Ω—é:** –§–∞–π–ª ‚Üí –ò–º–ø–æ—Ä—Ç ‚Üí Google Sheets

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è:** **Merge** (–Ω–µ destroy!)
- **Users**: –∏—â–µ—Ç –ø–æ `name`, –æ–±–Ω–æ–≤–ª—è–µ—Ç –µ—Å–ª–∏ –Ω–∞—à—ë–ª, —Å–æ–∑–¥–∞—ë—Ç –µ—Å–ª–∏ –Ω–µ—Ç
- **FunctionalItems**: –∏—â–µ—Ç –ø–æ `functional_id`, –æ–±–Ω–æ–≤–ª—è–µ—Ç/—Å–æ–∑–¥–∞—ë—Ç
- **Relations**: –∏—â–µ—Ç –ø–æ `source_id + target_id + type`, —Å–æ–∑–¥–∞—ë—Ç –µ—Å–ª–∏ –Ω–µ—Ç

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ - –Ω–µ —É–¥–∞–ª—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ
- –û–±–Ω–æ–≤–ª—è–µ—Ç –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–µ –ø–æ–ª—è
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–µ –Ω–∞—Ä–∞–±–æ—Ç–∫–∏

**–ü–æ—Ä—è–¥–æ–∫ –∏–º–ø–æ—Ä—Ç–∞:**
1. –°–Ω–∞—á–∞–ª–∞ Users (–Ω—É–∂–Ω—ã –¥–ª—è FK)
2. –ó–∞—Ç–µ–º FunctionalItems
3. –í –∫–æ–Ω—Ü–µ Relations

---

### CSV Import

**–ú–µ–Ω—é:** –§–∞–π–ª ‚Üí –ò–º–ø–æ—Ä—Ç ‚Üí CSV

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –∫–æ–ª–æ–Ω–æ–∫:**
- `FuncID` –∏–ª–∏ `Functional ID`
- `QA` –∏–ª–∏ `Responsible (QA)`
- `Dev` –∏–ª–∏ `Responsible (Dev)`
- `Crit` –∏–ª–∏ `isCrit` (TRUE/1/Yes/–î–∞)
- `Focus` –∏–ª–∏ `isFocus` (TRUE/1/Yes/–î–∞)

**–ê–≤—Ç–æ—Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
- –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç –≤ –ë–î - —Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**
```
üìä –ò–¢–û–ì–ò –ò–ú–ü–û–†–¢–ê:
  üìÅ –í—Å–µ–≥–æ —Å—Ç—Ä–æ–∫ –≤ CSV: 111
  ‚úÖ –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ: 111
  üë• –°–æ–∑–¥–∞–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 13
  ‚è≠Ô∏è  –ü—Ä–æ–ø—É—â–µ–Ω–æ (–ø—É—Å—Ç—ã–µ): 0
  ‚è≠Ô∏è  –ü—Ä–æ–ø—É—â–µ–Ω–æ (–¥—É–±–ª–∏): 0
  ‚ùå –û—à–∏–±–æ–∫: 0
```

---

## üîÑ –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å

### Backup –Ω–∞ –¥—Ä—É–≥–æ–π –∫–æ–º–ø—å—é—Ç–µ—Ä
```
–ú–∞—à–∏–Ω–∞ 1:
1. –§–∞–π–ª ‚Üí –≠–∫—Å–ø–æ—Ä—Ç ‚Üí Google Sheets
2. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å URL —Ç–∞–±–ª–∏—Ü—ã

–ú–∞—à–∏–Ω–∞ 2:
1. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí Google API ‚Üí –≤—Å—Ç–∞–≤–∏—Ç—å —Ç–æ—Ç –∂–µ JSON
2. –§–∞–π–ª ‚Üí –ò–º–ø–æ—Ä—Ç ‚Üí Google Sheets ‚Üí –≤—Å—Ç–∞–≤–∏—Ç—å URL
3. ‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
```

### –ë—ã—Å—Ç—Ä—ã–π backup —á–µ—Ä–µ–∑ CSV
```
1. –§–∞–π–ª ‚Üí –≠–∫—Å–ø–æ—Ä—Ç ‚Üí CSV ‚Üí —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞ Desktop
2. [–ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å]
3. –§–∞–π–ª ‚Üí –ò–º–ø–æ—Ä—Ç ‚Üí CSV ‚Üí –≤—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª —Å Desktop
```

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Google Sheets

### –°–æ–∑–¥–∞–Ω–∏–µ Service Account

1. –ü–µ—Ä–µ–π—Ç–∏ –≤ [Google Cloud Console](https://console.cloud.google.com/)
2. –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
3. –í–∫–ª—é—á–∏—Ç—å Google Sheets API
4. –°–æ–∑–¥–∞—Ç—å Service Account
5. –°–∫–∞—á–∞—Ç—å JSON –∫–ª—é—á

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ VoluptAS

1. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí Google API
2. –í—Å—Ç–∞–≤–∏—Ç—å –≤–µ—Å—å JSON –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å

### –†–∞—Å—à–∞—Ä–∏–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã

1. –û—Ç–∫—Ä—ã—Ç—å JSON —Ñ–∞–π–ª
2. –ù–∞–π—Ç–∏ `client_email`: `xxx@xxx.iam.gserviceaccount.com`
3. –í Google Sheets: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ—Å—Ç—É–ø–∞ ‚Üí –î–æ–±–∞–≤–∏—Ç—å email ‚Üí –†–µ–¥–∞–∫—Ç–æ—Ä
4. ‚úÖ –ì–æ—Ç–æ–≤–æ!

---

## üêõ Troubleshooting

### –û—à–∏–±–∫–∞ 403 Forbidden
**–ü—Ä–∏—á–∏–Ω–∞:** –¢–∞–±–ª–∏—Ü–∞ –Ω–µ —Ä–∞—Å—à–∞—Ä–µ–Ω–∞ –Ω–∞ service account  
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å `client_email` –∏–∑ JSON –∫–∞–∫ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞

### –û—à–∏–±–∫–∞ 429 Quota Exceeded
**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø–∏—Å–µ–π –≤ –º–∏–Ω—É—Ç—É (60 requests/min)  
**–†–µ—à–µ–Ω–∏–µ:** –ü–æ–¥–æ–∂–¥–∞—Ç—å 1 –º–∏–Ω—É—Ç—É, —ç–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—Å—è

### CSV –∏–º–ø–æ—Ä—Ç - –¥—É–±–ª–∏
**–ü—Ä–∏—á–∏–Ω–∞:** –≠–ª–µ–º–µ–Ω—Ç—ã —Å —Ç–∞–∫–∏–º functional_id —É–∂–µ –µ—Å—Ç—å  
**–†–µ—à–µ–Ω–∏–µ:** –ù–æ—Ä–º–∞–ª—å–Ω–æ, –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### Google –∏–º–ø–æ—Ä—Ç - –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö
**–ü—Ä–∏—á–∏–Ω–∞:** –õ–∏—Å—Ç—ã –ø—É—Å—Ç—ã–µ –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞  
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–º–µ–Ω–∞ –ª–∏—Å—Ç–æ–≤: "–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª", "–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏", "–°–≤—è–∑–∏"

---

## üìä –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### Google Sheets Client
- **–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞:** gspread + google-auth
- **Batch –∑–∞–ø–∏—Å—å:** append_rows –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤:** –≤—Å—Ç–∞–≤–∫–∞ 1 —Ä–∞–∑ –Ω–∞ –ª–∏—Å—Ç
- **clear_on_open:** False –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞, True –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞

### CSV Handler
- **–ö–æ–¥–∏—Ä–æ–≤–∫–∞:** UTF-8
- **Delimiter:** `,`
- **Quoting:** MINIMAL
- **–ê–≤—Ç–æ—Å–æ–∑–¥–∞–Ω–∏–µ Users:** —á–µ—Ä–µ–∑ get_or_create –ø–∞—Ç—Ç–µ—Ä–Ω

### Merge —Å—Ç—Ä–∞—Ç–µ–≥–∏—è
```python
# –ü—Ä–∏–º–µ—Ä –¥–ª—è FunctionalItem
item = session.query(FunctionalItem).filter_by(functional_id=func_id).first()
if item:
    # UPDATE
    for key, value in data.items():
        setattr(item, key, value)
else:
    # INSERT
    item = FunctionalItem(**data)
    session.add(item)
```
